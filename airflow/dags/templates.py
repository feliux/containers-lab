from airflow.models import DAG
from airflow.operators.bash_operator import BashOperator
from datetime import datetime

default_args = {
  "start_date": datetime(2020, 4, 15),
}

cleandata_dag = DAG(
    "cleandata",
    default_args=default_args,
    schedule_interval="@daily"
)

# Create a templated command to execute
# "bash cleandata.sh datestring"
templated_command = """bash cleandata.sh {{ ds_nodash }}"""

# Modify clean_task to use the templated command
clean_task = BashOperator(
    task_id="cleandata_task",
    bash_command=templated_command,
    params={
        "ds_nodash": "YYYYMMDD"
        },
        dag=cleandata_dag
)